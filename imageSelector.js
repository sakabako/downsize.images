!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("imageSelector",[],e):"object"==typeof exports?exports.imageSelector=e():t.imageSelector=e()}(this,function(){return function(t){function e(n){if(r[n])return r[n].exports;var i=r[n]={exports:{},id:n,loaded:!1};return t[n].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var r={};return e.m=t,e.c=r,e.p="",e(0)}([function(t,e,r){function n(t){0===l.length&&s.addEventListner(window,"resize",function(){for(var t=0;t<l.length;t++)l[t]()}),l.push(t)}function i(t,e){var r;return t.currentStyle?r=t.currentStyle[e]:window.getComputedStyle&&(r=document.defaultView.getComputedStyle(t,null).getPropertyValue(e)),r}function o(t){var e=t.clientWidth;if(0===e){var r=i(t,"width");if("auto"===r)e=o(t.parentNode);else if("%"===r.charAt(r.length-1)){var n=parseInt(r,10),u=o(t.parentNode);e=u*(n/100)}else e=parseInt(r,10)}return e}function u(t){var e=t.lastIndexOf(".");return t.substr(0,e)+"@2x"+t.substr(e)}function a(t,e){var r=t/e;return r<1&&(r/=2),Math.abs(1-r)}function c(t){return h[t]||(h[t]=function(e){return e.aspectRatio===t}),h[t]}function d(t,e){var r=t/e,n=r.toString();return v[n]||(v[n]=function(t){return t.width/t.height===r||(t.width+1)/t.height>=r&&(t.width-1)/t.height<=r}),v[n]}var s=r(1),f=window.devicePixelRatio&&window.devicePixelRatio>1.5,l=[],h={},v={};e.selectCutWithAspectRatio=function(t,r,n,i){return t=t.filter(c(n)),e.selectCut(t,r,i)},e.selectCutWithWidthAndHeight=function(t,r,n,i){return t=t.filter(d(r,n)),e.selectCut(t,r,i)},e.selectCut=function(t,e,r){void 0===r&&(r=.75);var n,i=1/0;for(var o in t){var u=t[o];if(e===u.width)return u;var c=a(u.width,e);c<r&&c<i&&(n=u,i=c)}return n},e.addSource=function(t,r,n){r=r||"src",n=n||JSON.parse(t.getAttribute("data-cuts"));var a,c=o(t),d=t.getAttribute("data-aspect-ratio");a=t.attributes.height&&t.attributes.height.specified?t.height:i(t,"height"),a=parseInt(a,10),r=t.getAttribute("data-src-attribute")||r,a<30&&(a=!1);var s;if(s=d?e.selectCutWithAspectRatio(n,c,d):a?e.selectCutWithWidthAndHeight(n,c,a):e.selectCut(n,c)){var l=s.src;f&&s.at2x&&s.width<1.5*c&&(l="string"==typeof s.at2x?s.at2x:u(l)),t.setAttribute(r,l)}else t.className+=" no-cut-found",t.setAttribute(r,"")},e.selectImages=function(t,r){t=t||document.body;for(var i,o=t.querySelectorAll("img[data-cuts]"),u=0;u<o.length;u++){i=o[u];try{var a=JSON.parse(i.getAttribute("data-cuts"));if(i.removeAttribute("data-cuts"),e.addSource(i,r,a),"true"===i.getAttribute("data-responsive")){var c=i.offsetWidth;n(function(){i.offsetWidth!==c&&(c=i.offsetWidth,e.addSource(i,r,a))})}}catch(t){console&&console.error&&console.error(t)}}}},function(t,e){function r(t,e,r,n){return c=c||(document.addEventListener?{add:i,rm:o}:{add:u,rm:a}),c.add(t,e,r,n)}function n(t,e,r,n){return c=c||(document.addEventListener?{add:i,rm:o}:{add:u,rm:a}),c.rm(t,e,r,n)}function i(t,e,r,n){t.addEventListener(e,r,n)}function o(t,e,r,n){t.removeEventListener(e,r,n)}function u(t,e,r,n){if(n)throw new Error("cannot useCapture in oldIE");t.attachEvent("on"+e,r)}function a(t,e,r,n){t.detachEvent("on"+e,r)}r.removeEventListener=n,r.addEventListener=r,t.exports=r;var c=null}])});
//# sourceMappingURL=imageSelector.js.map